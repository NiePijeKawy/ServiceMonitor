@model ServiceMonitor.Models.Performer.PerformerRejestractionViewModel
@{
    ViewBag.Title = "Registration";
}

<h2>Registration</h2>


<div class="container">
    @using (Html.BeginForm("Registration"))
    {
        <div class="col-xs-12">
            <div class="form-group">
                @Html.LabelFor(x=>x.Name,"Nazwa firmy")
                @Html.TextBoxFor(x=>x.Name, new {@class="form-control"})
            </div>
            <div class="form-group">
                @Html.LabelFor(x=>x.Login,"Login")
                @Html.TextBoxFor(x=>x.Login, new {@class="form-control"})
            </div>
            <div class="form-group">
                @Html.LabelFor(x=>x.Password,"Hasło")
                @Html.PasswordFor(x=>x.Password, new {@class="form-control"})
            </div>
            <div class="form-group">
                @Html.LabelFor(x=>x.PhoneNumber,"Numer telefonu")
                @Html.TextBoxFor(x=>x.PhoneNumber, new {@class="form-control"})
            </div>
            <div class="form-group">
                @Html.LabelFor(x=>x.VoivodershipId,"Wojewodzctwo");
                @Html.DropDownListFor(x => x.VoivodershipId, new SelectList(Model.Voivoderships,"Id", "DisplayName"), "Wybierz pozycję")
            </div>
            <div class="form-group">
                @Html.LabelFor(x => x.CountyId, "Powiat");
                @Html.DropDownListFor(x => x.CountyId, Enumerable.Empty<SelectListItem>(), "Wybierz pozycję")
                @*<select id="CountyList"></select>*@
            </div>            
            <div class="form-group">
                @Html.LabelFor(x => x.CommuneId, "Gmina");
                @Html.DropDownListFor(x => x.CommuneId, Enumerable.Empty<SelectListItem>(), "Wybierz pozycję")
            </div>   
            <div class="form-group">
                @Html.LabelFor(x => x.LocalityId, "Miejscowość");
                @Html.DropDownListFor(x => x.LocalityId, Enumerable.Empty<SelectListItem>(), "Wybierz pozycję")
            </div> 
            <div class="form-group">
                @Html.LabelFor(x=>x.Street,"Ulica")
                @Html.TextBoxFor(x=>x.Street, new {@class="form-control"})
            </div>
            <div class="form-group">
                @Html.LabelFor(x=>x.HouseNumber,"Numer domu/mieszkania")
                @Html.TextBoxFor(x=>x.HouseNumber, new {@class="form-control"})
            </div>
            <button type="submit" class="btn btn-group">Dodaj</button>
            <button type="button">@Html.ActionLink("Anuluj","Index","Performer")</button>
            @Html.ValidationSummary();
        </div>
    }


</div>

<script>

    $(document).ready(function () {

        $("#VoivodershipId").change(function () {

            $('#CountyId').empty();
            $('#CommuneId').empty();
            $('#LocalityId').empty();
        
            var value = $("#VoivodershipId").val();
            $.ajax({
                type: 'get',
                url: '@Url.Action("GetCounty", "Performer")',
                data: { idVoivodeship: value },
                success: function (data) {
                    
                    var tmp = $("#CountyId");
                       for (var val in data) {
                           $('<option />', { value: data[val].Id, text: data[val].DisplayName }).appendTo(tmp);
                       }
                    },
                error: function (data) {console.log("Error");}
                });
        });

        $("#CountyId").change(function () {

            $('#CommuneId').empty();
            $('#LocalityId').empty();

            var value = $("#CountyId").val();
            console.log(value);
            $.ajax({
                type: 'get',
                url: '@Url.Action("GetCommune", "Performer")',
                data: { idCounty: value },
                success: function (data) {

                    var tmp = $("#CommuneId");
                    for (var val in data) {
                        $('<option />', { value: data[val].Id, text: data[val].DisplayName }).appendTo(tmp);
                    }
                },
                error: function (data) { console.log("Error"); }
            });
        });

        
        $("#CommuneId").change(function () {

            $('#LocalityId').empty();
            var value = $("#CommuneId").val();
            console.log(value);
            $.ajax({
                type: 'get',
                url: '@Url.Action("GetLocality", "Performer")',
                data: { idCommune: value },
                success: function (data) {

                    var tmp = $("#LocalityId");
                    for (var val in data) {
                        $('<option />', { value: data[val].Id, text: data[val].DisplayName }).appendTo(tmp);
                    }
                },
                error: function (data) { console.log("Error"); }
            });
        });


    });

</script>
